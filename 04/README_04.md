---
marp: true
theme: default
paginate: true
------

<style>
    :root {
        font-size: 1.75em;
        font-family: Helvetica, "Hiragino Kaku Gothic Pro", sans-serif;
        line-height: 1.75;
    }
    h1,h2,h3 {
        font-family:
            "Avenir Next",
            Futura,
            sans-serif;

        line-height: 1.25;
    }
</style>

# ART_OF_CODE #4
p5.js で学ぶ JavaScript

---

## 前回のおさらい 1/2

### 条件分岐（ `if` 文 ）
ある**特定の条件**を満たした場合にのみ実行させたい処理がある場合、
`if` で条件判定を行う。

```js
if (比較式) {
    // 実行内容
}
```

`比較式` が **`真(true)`** なら **`{ }` 内に書いたコードが実行され**、
逆に **`偽(false)`** なら**何も実行されない**。

---

#### 比較式の記述例
```js
if (x < y) {  // x が y よりも小さい場合は 真
```
```js
if (x > y) {  // x が y よりも大きい場合は 真
```
```js
if (x == y) { // x が y と等しい場合は 真
```
```js
if (x != y) { // x が y と等しくない場合は 真
```
```js
if (x <= y) { // x が y 以下の場合は 真
```
```js
if (x >= y) { // x が y 以上の場合は 真
```

---

ちなみに比較式の判定結果を **変数に保存** することも可能。

```js
// 変数:cond に x < y の真偽値を保存
let cond = x < y;

 // 変数:cond を if 文の条件として使う
if (cond) {
    alert('x は y より小さい。');
}
```

---

## 前回のおさらい 2/2

### ループ処理（ `for` 文 ）
同じ処理を一定の回数分だけ **繰り返し実行** させたい場合は `for` 文を使う。
仮に、`alert` 関数を **12 回** 繰り返す場合は以下のような記述になる。

```js
for (let i = 0; i < 12; i++) {
    alert(i + '回目'); // '0回目', '1回目', '2回目' ...
}
```

変数 `i` は **ループカウンター** と呼び、**`{ }` 内が実行される度に `+1`** される。
`i` が `12` になると `for` 文は終了する。

---

この `for` 文を分解するとこうなる。
| 手順 | 実行内容 | 説明 |
|:---:|:--------|:----|
| 1. | `let i = 0` | ループカウンタの宣言 |
| 2. | `i < 12` | 条件判定（条件に合致しなければ `for` 文を終了する） |
| 3. | `alert(i + '回目');` | `{ }` のコードの実行 |
| 4. | `i++` | ループカウンタに +1 |
| 5. |  | 手順 2. に戻る |

---

## 高度な条件分岐

---

### `else`
`if` 文を使い条件判定が行えることを学んだ。
`if` 文の直後に **`else`** 句を付帯させると、
逆に **条件に合致しなかった場合** にのみコード実行させることができる。

---

```js
if (x < y) {
    // 条件を満たす場合
    alert('A');

} else {
    // 条件を満たさない場合
    alert('B');
}
```

上記の例は
- `x < y` が *真 (true)* なら `alert('A')` が実行され、
- `x < y` が *偽 (false)* なら `alert('B')` が実行される。

---

`else` 句は、必ず **`if` 文の後ろに付帯**するもので、
**`else` 句単体で記述することはできない**。

```js
// これは構文エラー
else {

}
```
```js
// これは OK
if (a == b) {

} else {

}
```

---

### `else if`
**`else` に `if` を追加**し、**別の条件判定**を付加することもできる。

```js
if (x < y) {
    // x < y  が 真 なら
    alert('A');

} else if (x == 1) {
    // x < y  が 偽 で、
    // x == 1 が 真 なら
    alert('B');
}
```

この場合、最初の `if` が *偽 (false)* の時のみ、
`else if` の条件判定が行われる。

どちらの条件にも合致しなかった場合は、何も実行されない。

---

複数の `else if` を繋げて、
**3つ以上の条件分岐**をつくることも可能。
```js
if (a == 1) {        // 分岐:1
    alert('分岐:1');

} else if (a == 2) { // 分岐:2
    alert('分岐:2');

} else if (a == 3) { // 分岐:3
    alert('分岐:3');

} else { // いずれの条件も満たさなかった場合
    alert('分岐:4');
}
```

サンプルスケッチで確認してみよう。
https://editor.p5js.org/amekusa/sketches/3YAjHkOI-

---

## `while` ループ

---

`for` 文を使うことによって、
同じ処理を繰り返し実行させるコードの書き方を学んだが、
ループを実現させる方法は他にもある。

---

`for` 文は、**決められた回数分** だけループさせたい場合に有用だが、
時には、何回ループさせるべきかを **正確には定められない**,
あるいは **定めたくない** というケースもあるだろう。

そのような場合に有用なのが **`while`** ループだ。

---

### 書き方:

```js
while (条件) {
    // 実行内容
}
```

書式は **`if` 文とよく似ている**。
**`条件`** には `if` 文で使用するのと同じ **比較式** が入る。
比較式が *真 (true)* の場合のみ `{ }` 内が実行されるのも `if` 文と同じである。

`if` 文と違う点は、
**条件が満たされている限り、`{ }` が繰り返し実行され続ける** というものだ。

---

```js
let i = 0
while (i < 3) {
    alert(i);
}
```

例えばこのコードは、一度実行されると
**ブラウザのタブを閉じるか、ブラウザを終了**させるまで
永遠に `alert(0)` を実行し続ける、文字通りの **無限ループ** となる。

（ただし最近のブラウザは無限ループを検出し、コードの実行を自動的に中断するなどのセーフティ機能が備わっている。）

---

実際に実行して動作を確認してみよう。

p5.js エディターで無限ループを実行するには、最初の行に
```js
// noprotect
```
と記述し、セーフティ機能を外す必要がある。

---

一般的に、**無限ループは望ましいものではない**。

どんな方法にせよ、外的な力によって**プログラムを強制的に止める**しかなくなってしまうからだ。それはユーザーに不便を強いることになってしまうし、
何よりプログラムの終わり方として美しい形とは言えない。

**完成されたプログラムとは、自らの終わり方まで完璧に記述されているというものだ。**

---

では `while` ループを終了させるにはどうしたらよいだろう。
方法は二つある。

一つは、**ループの実行条件が成立しない状態**にすればよい。

---

```js
let i = 0
while (i < 3) {
    alert(i);
    i++; // i に +1
}
```

先ほどの無限ループに 1 行書き加えてみた。
**`++`** は **インクリメント** といい、**変数に 1 加える** 役割をもつ演算子だ。

```js
i = i + 1;
```

このように書くのと同じ意味を持つ。

---

これも実際に実行して動作を確認してみてほしい。

`{ }` 内が実行される度に、変数 `i` がインクリメントされ、
**3 度目の実行で `i` は `3` となる**。

それによって **比較式 `i < 3` は 偽 (false) となる**。
つまりループの実行条件が**成立しない状態となった**ため、
この `while` ループは **3 度目で終了する**。

---

### `break`
`while` を終了させるもう一つの方法は、**`break` 文を用いることだ**。

```js
let i = 0;
while (i < 3) {
    alert(i);
    break; // ループはここで終了する
}
```

`while` ループ実行中に **`break;`** と記述された行に到達すると、
その `while` ループは **即座に終了する**。

たとえループの実行条件が成立していようとも、**問答無用でループを抜ける**。

---

`while` ループ内の **`if` 文の中に `break` 文を書く**ことで、
**特定の条件に達したらループを抜ける** というような処理を実現させることができる。

```js
while (true) {
    let dice = round(random(1, 6)); // サイコロを振る
    alert('出目は' + dice);

    // 出目が 4 以上ならループを抜ける
    if (dice >= 4) {
        break;
    }
}
```

**`true`** は **真** の値を表す。ゆえに `while (true)` は **必ず無限ループになる**。
しかし `if` 文を用い、
**適切な条件で `break` 文が実行される**ようにプログラムしておけば問題ない。

---

サンプルコード:
https://editor.p5js.org/amekusa/sketches/fThVmGvza